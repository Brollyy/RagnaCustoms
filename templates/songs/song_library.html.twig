{% extends 'base_v2.html.twig' %}

{% block title %}RagnaCustoms.com, Custom song library{% endblock %}

{% block body %}
    <div class="container">
        <div class="row pt-5">
            <div class="col-md-10 text-left">
                <h1 class="">
                    {{ "Custom song library"|trans }}
                </h1>
                <button data-toggle="tooltips" title="{{ "Download this selection"|trans }}"
                        type="submit" name="onclick_dl" value="42" class="btn btn-sm btn-success float-right"
                        data-confirm="{{ "You are going to download a lot of custom songs and it can take a while, do you want to continue?"|trans }}">
                    <i class="fas fa-download"></i> {{ '1 click'|trans }}</button>
            </div>
        </div>
        <div class="row">
            <div class="col-md-10">
                <table class="featured-table-lg table table-sm">
                    <tr>
                        <th>{{ "Title"|trans }}</th>
                        <th>{{ "Difficulties"|trans }}</th>
                        <th>{{ "Mapper"|trans }}</th>
                        <th>{{ "Votes"|trans }}</th>
                        <th>{{ "Rating"|trans }}</th>
                        <th class="text-right">{{ "Upload Date"|trans }}</th>
                        <th class="text-right">{{ "Downloads"|trans }}</th>
                        <th></th>
                    </tr>
                {% for song in songs.entities %}
                    {% include 'songs/partial/song_row.html.twig' with {songs:songs} %}
                {% else %}

                    <tr class="row">
                        <td colspan="8">
                            {{ "No song for now"|trans }}
                        </td>
                    </tr>
                {% endfor %}
                </table>
                <div class="col-12 d-flex justify-content-between">
                    {% if songs is not null %}
                        {% import "@Pagination/Pagination/macro.twig" as macro_pagination %}
                        <div class="text-left pagination">
                            {{ "Pages:"|trans }} {{ macro_pagination.paginate(songs) }}
                        </div>
                        <div class="text-right">{{ songs.entities|length }} {{ "songs displayed on"|trans }} {{ songs.count }}</div>
                    {% endif %}
                    {# {{ macro_pagination.seeMore(songs,"see more"|trans,'btn',{"parent":"#table-song","remove":"#see-more-place"}) }} #}
                </div>

            </div>
            <div class="col-md-2">
                <div id="search-bar">
                    <form class=" search-and-filter">
                        <div class="row">
                            <div class="col-md-4 form-group active">
                                <label for="search">{{ "Search"|trans }}</label>
                                <input type="text" value="{{ app.request.get('search') }}"
                                       class="form-control form-control-sm"
                                       placeholder="{{ "Search by title, artist or mapper"|trans }}" name="search"
                                       id="search">
                            </div>
                            <div class="col-md-2 form-group">
                                <label for="downloads-category">{{ "Categories"|trans }}</label>
                                <select data-placeholder="All" id="downloads-category" data-allow-clear="true"
                                        data-tags="false" name="downloads_filter_categories[]"
                                        class="form-control form-control-sm select2" multiple="true">
                                    {% for category in categories %}
                                        <option {% if category.id in app.request.get('downloads_filter_categories') %}selected="selected"{% endif %}
                                                value="{{ category.id }}">{{ category.label }}</option>                                {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-1 form-group">
                                <label for="downloads-filter-category">{{ "Difficulties"|trans }}</label>
                                <select id="downloads-filter-category" name="downloads_filter_difficulties"
                                        class="form-control form-control-sm">
                                    <option value="">{{ "All"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_difficulties') == 1 %}selected="selected"{% endif %}
                                            value="1">{{ "1-3"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_difficulties') == 2 %}selected="selected"{% endif %}
                                            value="2">{{ "4-7"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_difficulties') == 3 %}selected="selected"{% endif %}
                                            value="3">{{ "8-10"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_difficulties') == 6 %}selected="selected"{% endif %}
                                            value="6">{{ "10+"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_difficulties') == 4 %}selected="selected"{% endif %}
                                            value="4">{{ "Ranked only"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_difficulties') == 5 %}selected="selected"{% endif %}
                                            value="5">{{ "WIP only"|trans }}</option>

                                </select>
                            </div>
                            <div class="col-md-1 form-group ">
                                <label for="downloads-filter-converted">{{ "Converted map"|trans }}</label>
                                <select id="downloads-filter-converted" name="converted_maps"
                                        class="form-control form-control-sm">
                                    <option value="">{{ "With"|trans }}</option>
                                    <option {% if app.request.get('converted_maps') == 1 %}selected="selected"{% endif %}
                                            value="1">{{ "Without"|trans }}</option>
                                    <option {% if app.request.get('converted_maps') == 2 %}selected="selected"{% endif %}
                                            value="2">{{ "Only converted"|trans }}</option>
                                </select>

                            </div>
                            <div class="col-md-2 form-group ">
                                <label for="downloads-filter-order">{{ "Order by"|trans }}</label>
                                <select id="downloads-filter-order" name="downloads_filter_order"
                                        class="form-control form-control-sm">
                                    <option value="">{{ "Last added"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_order') == 3 %}selected="selected"{% endif %}
                                            value="3">{{ "Last updated"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_order') == 1 %}selected="selected"{% endif %}
                                            value="1">{{ "Vote"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_order') == 2 %}selected="selected"{% endif %}
                                            value="2">{{ "Duration"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_order') == 4 %}selected="selected"{% endif %}
                                            value="4">{{ "Alphabetical"|trans }}</option>
                                    <option {% if app.request.get('downloads_filter_order') == 5 %}selected="selected"{% endif %}
                                            value="5">{{ "Most downloaded"|trans }}</option>
                                </select>
                            </div>
                            <div class="col-md-2 form-group">
                                <label>&nbsp;</label><br/>
                                <button type="submit" name="search_btn" value="1"
                                        class="btn btn-sm btn-primary">{{ "Filter songs"|trans }}</button>
                                <button data-toggle="tooltips" title="{{ "Download filtered selection"|trans }}"
                                        type="submit" name="onclick_dl" value="42" class="btn btn-sm btn-danger"
                                        data-confirm="{{ "You are going to download a lot of custom songs and it can take a while, do you want to continue?"|trans }}">
                                    <i class="fas fa-download"></i></button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

   {% block stylesheets %}
       {{ parent() }}
       {{ encore_entry_link_tags('ragnabeat') }}
   {% endblock %}
    {% block javascripts %}
        {{ parent() }}
        {{ encore_entry_script_tags('ragnabeat') }}
        {{ encore_entry_script_tags('ajax-search') }}
    {% endblock %}